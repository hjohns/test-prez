import{_ as L,a as j}from"./Loading.vue.1b0e05ea.js";import{j as F,y as I,q as d,o as n,c as a,t as k,g as o,z as m,b as i,w as b,d as q,h as T,a as g,F as S,n as $,s as H,r as z,k as P,f as V,B as U,C as D,m as E,D as N,i as M}from"./entry.bcf69c92.js";import{a as W}from"./str.08505d9c.js";import{_ as A}from"./_plugin-vue_export-helper.c27b6911.js";import{u as O}from"./rdf.477be283.js";import{c as B}from"./config.cac9e108.js";import"./axios.7bde71be.js";const Q={style:{position:"relative"}},G={key:0,class:"text-h3 mb-5 mt-2"},J={style:{"white-space":"nowrap"}},K=["href","title"],X={key:1},Y=["onClick"],Z=["title"],ee=F({__name:"Search",props:{list:{},headerTitle:{},excludeFields:{},fields:{},info:{type:Boolean},links:{}},setup(R){const s=R,p=s.excludeFields?s.excludeFields:[/^prez:./],h=(s.fields?s.fields:Object.keys(s.list.listHeaders)).filter(e=>{for(const f in p)if(e.match(p[f]))return!!(s.fields&&s.fields.indexOf(e)>=0);return!0});return console.log("LIST =",s.list),I(),(e,f)=>{const _=d("v-chip"),u=d("v-icon"),v=d("v-btn"),c=d("v-table"),y=L;return n(),a("div",Q,[e.headerTitle&&e.list?(n(),a("div",G,k(o(W)(e.headerTitle,e.list)),1)):m("",!0),i(_,{variant:"flat",style:{position:"absolute",right:"0",top:"0"}},{default:b(()=>[q(k(e.list.header.label),1)]),_:1}),e.list?(n(),T(c,{key:1,theme:"dark"},{default:b(()=>[g("thead",null,[g("tr",null,[(n(!0),a(S,null,$(o(h),t=>(n(),a("th",J,[q(k(t in e.list.listHeaders?e.list.listHeaders[t].label:`${t} missing`)+" Â ",1),t in e.list.listHeaders?(n(),a("a",{key:0,href:e.list.listHeaders[t].iri,title:t},[i(u,{icon:"mdi-link"})],8,K)):m("",!0),e.info?(n(),a("div",X,k(t),1)):m("",!0)]))),256))])]),g("tbody",null,[(n(!0),a(S,null,$(e.list.list,t=>(n(),a("tr",{onClick:r=>typeof t["prez:link"]=="string"?e.$router.push(t["prez:link"]):null},[(n(!0),a(S,null,$(o(h),r=>(n(),a("td",null,[g("div",{title:r in t?t[r]:null,class:"td-max"},[r=="prez:link"?(n(!0),a(S,{key:0},$(typeof t[r]=="object"?t[r]:[t[r]],l=>(n(),T(v,{class:"mr-4",to:l},{default:b(()=>[q(k(l),1)]),_:2},1032,["to"]))),256)):m("",!0),q(" "+k(r!="prez:link"?r in t?t[r]:`"${r}" not found`:""),1)],8,Z)]))),256))],8,Y))),256))])]),_:1})):m("",!0),i(y,{links:e.links},null,8,["links"])])}}});const te=A(ee,[["__scopeId","data-v-773c9f79"]]),se=F({__name:"Search",props:{dataUrl:{},headerTitle:{},excludeFields:{},fields:{},info:{type:Boolean}},setup(R){const s=R,p=O(),{loading:h,success:e,error:f,prez:_}=H(p),u=z(null),v=z(1),c=z(void 0);P(async()=>{await r()});const y=V(),t=z(y.query);U(()=>t.value=y.query,()=>{});async function r(){if(await p.load(s.dataUrl,{params:{page:v.value}}),e.value)try{u.value=null,c.value=_.value.search(["skos:prefLabel","rdfs:label"]),c.value.list.sort((l,x)=>{const w=parseInt(l["prez:searchResultWeight"]),C=parseInt(x["prez:searchResultWeight"]);return w>C?1:w<C?-1:0})}catch(l){u.value=l.message}}return(l,x)=>{const w=te,C=j;return n(),a(S,null,[o(c)?(n(),T(w,{key:0,"header-title":l.headerTitle,list:o(c),fields:l.fields,"exclude-fields":l.excludeFields,info:l.info,links:o(_).headerLinks},null,8,["header-title","list","fields","exclude-fields","info","links"])):m("",!0),i(C,{loading:o(h),error:o(f)},null,8,["loading","error"]),i(C,{loading:!1,error:o(u)},null,8,["error"])],64)}}}),ne={class:"justify-center"},oe=g("h1",{class:"mb-5"},"Text search",-1),re=["onSubmit"],_e=F({__name:"search",setup(R){const s=V(),p=I(),h=M(),e=z(s.query.q);function f(){p.push({path:"/search",query:{...s.query,q:e.value}})}const _=D(()=>"q"in s.query&&s.query.q!==""?s.fullPath:null);return(u,v)=>{const c=d("v-text-field"),y=d("v-btn"),t=d("v-card-text"),r=d("v-card"),l=se;return n(),a("div",ne,[i(r,{class:"mx-auto","max-width":"800",flat:""},{default:b(()=>[i(t,null,{default:b(()=>[oe,g("form",{class:"d-flex justify-end mt-5",method:"get",onSubmit:N(f,["stop","prevent"])},[i(c,{loading:u.loading,density:"compact",variant:"solo",label:"Enter text to lookup","append-inner-icon":"mdi-magnify","single-line":"","hide-details":"",autofocus:!0,name:"q",modelValue:o(e),"onUpdate:modelValue":v[0]||(v[0]=x=>E(e)?e.value=x:null),"onClick:appendInner":u.onClick},null,8,["loading","modelValue","onClick:appendInner"]),i(y,{type:"submit",color:"primary",class:"ml-5 pl-4 pr-4",size:"medium"},{default:b(()=>[q("Search")]),_:1})],40,re)]),_:1})]),_:1}),o(_)?(n(),T(l,{key:o(_),"header-title":"{{ count }} Result(s)","data-url":o(B).getUrl(o(B).API_BASE_URL+o(s).fullPath,o(h)),fields:["prez:searchResultMatch","prez:searchResultPredicate","prez:searchResultWeight"]},null,8,["header-title","data-url"])):m("",!0)])}}});export{_e as default};
